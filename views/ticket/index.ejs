<%- include('../../components/header/_index.ejs') %>
<div class="mb-4 font-bold text-teal-900 dark:text-white"><%= title %></div>

<div id="ticket-list" class="text-xs">
    <div v-if="fetchedTickets.length > 0">
        <div
            class="lg:grid grid-flow-col grid-cols-12 gap-1 shadow-sm"
        >
            <div
                @click="setSorting('id', false)"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'id' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'id' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Numer
            </div>
            <div
                @click="setSorting('priority', true)"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'priority' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'priority' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Priorytet
            </div>
            <div
                @click="setSorting('title', false)"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center col-span-4"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'title' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'title' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Tytuł
            </div>
            <div
                @click="setSorting('issuedBy', true)"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center col-span-2"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'issuedBy' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'issuedBy' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Zgłosił
            </div>
            <div
                @click="setSorting('assignedTo', true)"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center col-span-2"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'assignedTo' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'assignedTo' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Przypisane
            </div>
            <div
                @click="setSorting('updatedOn'), false"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'updatedOn' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'updatedOn' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Odświeżono
            </div>
            <div
                @click="setSorting('createdOn'), false"
                class="hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer p-1 py-2 font-bold text-center flex flex-row justify-center items-center"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    :class="{'transform rotate-180': sorting.direction == -1}"
                    v-if="sorting.property == 'createdOn' && (sorting.direction == 1 || sorting.direction == -1)"
                >
                    <path
                        d="M6.41,9H17.59a1,1,0,0,1,.7,1.71l-5.58,5.58a1,1,0,0,1-1.42,0L5.71,10.71A1,1,0,0,1,6.41,9Z"
                    />
                </svg>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                    v-if="sorting.property == 'createdOn' && sorting.direction == 2"
                >
                    <path
                        d="M7,0H4A4,4,0,0,0,0,4V7a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V4A4,4,0,0,0,7,0ZM9,7A2,2,0,0,1,7,9H4A2,2,0,0,1,2,7V4A2,2,0,0,1,4,2H7A2,2,0,0,1,9,4Z"
                    />
                    <path
                        d="M7,13H4a4,4,0,0,0-4,4v3a4,4,0,0,0,4,4H7a4,4,0,0,0,4-4V17A4,4,0,0,0,7,13Zm2,7a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V17a2,2,0,0,1,2-2H7a2,2,0,0,1,2,2Z"
                    />
                    <path
                        d="M22.293,19.049,20,21.339V2.633l2.293,2.29a1,1,0,1,0,1.414-1.415L21.12.925a3,3,0,0,0-4.24,0L14.293,3.508a1,1,0,1,0,1.414,1.415L18,2.633V21.339l-2.293-2.29a1,1,0,1,0-1.414,1.415l2.587,2.583a3,3,0,0,0,4.24,0l2.587-2.583a1,1,0,1,0-1.414-1.415Z"
                    />
                </svg>
                Utworzone
            </div>
        </div>
        <div v-if="this.sorting.direction != 2" class="">
            <div
                v-for="(ticket, index) in tickets"
                :key="index"
                class="lg:grid border border-slate-50 dark:border-slate-500 p-2 grid-flow-col grid-cols-12 gap-1 my-1 hover:bg-teal-50 dark:hover:bg-slate-700 transition-colors cursor-pointer overflow-hidden break-all lg:border-none lg:border-slate-50 lg:dark:border-slate-700 lg:p-0"
                @click="goTo(ticket.id)"
                :class="{
                    '': ticket.status == 'new',
                    'bg-amber-200 dark:bg-yellow-700': ticket.status == 'in-progress',
                    'bg-slate-100 text-slate-400 dark:bg-slate-800 dark:text-slate-500': ticket.status == 'done'
                }"
            >
                <div
                    class="flex flex-row items-center justify-center p-1 font-mono"
                >
                    {{ ticket.id }}
                </div>
                <div class="flex flex-row items-center justify-center p-1">
                    <svg
                        v-if="ticket.priority == 'none'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-teal-900"
                    >
                        <path
                            d="M9.609,19.2l-.6,3.974a1,1,0,0,1-.98.8.99.99,0,0,1-.2-.02,1,1,0,0,1-.781-1.179l.6-3.974a1,1,0,0,1,1.961.4ZM10,2.5A2.5,2.5,0,1,1,12.5,5,2.5,2.5,0,0,1,10,2.5ZM20,7a1,1,0,0,0-1,1v2H16.618L15.447,7.658A3,3,0,0,0,12.764,6H10.418A1.5,1.5,0,0,0,8.942,7.231l-1.049,5.76A2.988,2.988,0,0,0,9.2,16.08L13,18.543V23a1,1,0,0,0,2,0V18a1,1,0,0,0-.456-.839l-1.206-.783,1.13-6.206.637,1.275A1,1,0,0,0,16,12h3V23a1,1,0,0,0,2,0V8A1,1,0,0,0,20,7ZM6.4,15.893A2.7,2.7,0,0,1,5.67,16,2.765,2.765,0,0,1,3,12.971,7.68,7.68,0,0,1,7.065,6.676L5.91,12.61A4.974,4.974,0,0,0,6.4,15.893Z"
                        />
                    </svg>
                    <svg
                        v-if="ticket.priority == 'low'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-teal-500"
                    >
                        <g id="_01_align_center" data-name="01 align center">
                            <path
                                d="M12,24A12,12,0,1,1,24,12,12.013,12.013,0,0,1,12,24ZM12,2A10,10,0,1,0,22,12,10.011,10.011,0,0,0,12,2Z"
                            />
                            <rect x="11" y="5" width="2" height="10" />
                            <rect x="11" y="17" width="2" height="2" />
                        </g>
                    </svg>
                    <svg
                        v-if="ticket.priority == 'medium'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-amber-500"
                    >
                        <g id="_01_align_center" data-name="01 align center">
                            <path
                                d="M12,24A12,12,0,1,1,24,12,12.013,12.013,0,0,1,12,24ZM12,2A10,10,0,1,0,22,12,10.011,10.011,0,0,0,12,2Z"
                            />
                            <rect x="11" y="5" width="2" height="10" />
                            <rect x="11" y="17" width="2" height="2" />
                        </g>
                    </svg>
                    <svg
                        v-if="ticket.priority == 'high'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-red-500"
                    >
                        <path
                            d="M24,12A12,12,0,1,1,12,0,12.013,12.013,0,0,1,24,12ZM13,5H11V15h2Zm0,12H11v2h2Z"
                        />
                    </svg>
                    <div
                        v-if="ticket.priority == 'critical'"
                        class="flex flex-row align-middle items-center font-bold text-red-700"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                            class="w-4 h-4 mr-1 fill-current"
                        >
                            <path
                                d="M24,12A12,12,0,1,1,12,0,12.013,12.013,0,0,1,24,12ZM13,5H11V15h2Zm0,12H11v2h2Z"
                            />
                        </svg>
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                            class="w-4 h-4 mr-1 fill-current"
                        >
                            <path
                                d="M23,12a1,1,0,0,1-1,1H19.13a3.016,3.016,0,0,1-2.569-1.452L15.193,9.277,13.706,12.9a1,1,0,0,1-1.851-.758L13.555,8H11.616L9.552,13.032a1,1,0,0,0,.39,1.225l4.592,2.9A1,1,0,0,1,15,18v5a1,1,0,0,1-2,0V18.551l-4.126-2.6A3,3,0,0,1,7.7,12.273L9.454,8H7.236a.994.994,0,0,0-.894.552L4.895,11.447a1,1,0,0,1-1.79-.894l1.448-2.9A2.984,2.984,0,0,1,7.236,6h6.623A3.017,3.017,0,0,1,16.43,7.453l1.844,3.063A1.006,1.006,0,0,0,19.13,11H22A1,1,0,0,1,23,12ZM7.875,16.814a1,1,0,0,0-1.3.557A.994.994,0,0,1,5.646,18H3a1,1,0,0,0,0,2H5.646a2.987,2.987,0,0,0,2.786-1.886A1,1,0,0,0,7.875,16.814ZM15,5a2.5,2.5,0,1,0-2.5-2.5A2.5,2.5,0,0,0,15,5Z"
                            />
                        </svg>
                    </div>
                </div>
                <div class="p-1 col-span-4">
                    <div class="font-bold">{{ ticket.title }}</div>
                    <div class="text-slate-700 dark:text-slate-400">
                        {{ ticket.description_ex }}
                    </div>
                </div>
                <div
                    class="flex flex-row items-center justify-center p-1 col-span-2"
                >
                    {{ ticket.issuedBy }}
                </div>
                <div
                    class="flex flex-row items-center justify-center p-1 col-span-2"
                >
                    {{ ticket.assignedTo }}
                </div>
                <div class="flex flex-row items-center justify-center p-1">
                    {{ ticket.updatedOn }}
                </div>
                <div class="flex flex-row items-center justify-center p-1">
                    {{ ticket.createdOn }}
                </div>
            </div>
        </div>

        <div v-else v-for="[key, value] in Object.entries(tickets)" :key="key">
            <div class="px-4 py-2 text-xs flex flex-row items-center">
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 mr-1 fill-current"
                >
                    <path
                        d="M0,5V19a5.006,5.006,0,0,0,5,5H19a5.006,5.006,0,0,0,5-5V5a5.006,5.006,0,0,0-5-5H5A5.006,5.006,0,0,0,0,5ZM19,2a3,3,0,0,1,3,3V19a3,3,0,0,1-3,3H5a3,3,0,0,1-3-3V5A3,3,0,0,1,5,2ZM13.121,6.293a1,1,0,0,0,0,1.414L16.413,11,6,11.007a1,1,0,1,0,0,2L16.414,13l-3.293,3.293a1,1,0,1,0,1.389,1.438l.025-.024,3.586-3.585a3,3,0,0,0,0-4.243h0L14.535,6.293A1,1,0,0,0,13.121,6.293Z"
                    />
                </svg>
                {{sorting.property}} &rArr; {{ key }}
            </div>
            <div
                v-for="(ticket, index) in tickets[key]"
                :key="index"
                class="lg:grid border border-slate-50 dark:border-slate-500 p-2 grid-flow-col grid-cols-12 gap-1 my-1 hover:bg-teal-50 dark:hover:bg-slate-700 transition-colors cursor-pointer overflow-hidden break-all lg:border-none lg:border-slate-50 lg:dark:border-slate-700 lg:p-0"
                @click="goTo(ticket.id)"
                :class="{
                    'bg-amber-200 dark:bg-yellow-700': ticket.status == 'in-progress',
                    'bg-slate-100 text-slate-400 dark:bg-slate-800 dark:text-slate-500': ticket.status == 'done'
                }"
            >
                <div
                    class="flex flex-row items-center justify-center p-1 font-mono"
                >
                    {{ ticket.id }}
                </div>
                <div class="flex flex-row items-center justify-center p-1">
                    <svg
                        v-if="ticket.priority == 'none'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-teal-900"
                    >
                        <path
                            d="M9.609,19.2l-.6,3.974a1,1,0,0,1-.98.8.99.99,0,0,1-.2-.02,1,1,0,0,1-.781-1.179l.6-3.974a1,1,0,0,1,1.961.4ZM10,2.5A2.5,2.5,0,1,1,12.5,5,2.5,2.5,0,0,1,10,2.5ZM20,7a1,1,0,0,0-1,1v2H16.618L15.447,7.658A3,3,0,0,0,12.764,6H10.418A1.5,1.5,0,0,0,8.942,7.231l-1.049,5.76A2.988,2.988,0,0,0,9.2,16.08L13,18.543V23a1,1,0,0,0,2,0V18a1,1,0,0,0-.456-.839l-1.206-.783,1.13-6.206.637,1.275A1,1,0,0,0,16,12h3V23a1,1,0,0,0,2,0V8A1,1,0,0,0,20,7ZM6.4,15.893A2.7,2.7,0,0,1,5.67,16,2.765,2.765,0,0,1,3,12.971,7.68,7.68,0,0,1,7.065,6.676L5.91,12.61A4.974,4.974,0,0,0,6.4,15.893Z"
                        />
                    </svg>
                    <svg
                        v-if="ticket.priority == 'low'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-teal-500"
                    >
                        <g id="_01_align_center" data-name="01 align center">
                            <path
                                d="M12,24A12,12,0,1,1,24,12,12.013,12.013,0,0,1,12,24ZM12,2A10,10,0,1,0,22,12,10.011,10.011,0,0,0,12,2Z"
                            />
                            <rect x="11" y="5" width="2" height="10" />
                            <rect x="11" y="17" width="2" height="2" />
                        </g>
                    </svg>
                    <svg
                        v-if="ticket.priority == 'medium'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-amber-500"
                    >
                        <g id="_01_align_center" data-name="01 align center">
                            <path
                                d="M12,24A12,12,0,1,1,24,12,12.013,12.013,0,0,1,12,24ZM12,2A10,10,0,1,0,22,12,10.011,10.011,0,0,0,12,2Z"
                            />
                            <rect x="11" y="5" width="2" height="10" />
                            <rect x="11" y="17" width="2" height="2" />
                        </g>
                    </svg>
                    <svg
                        v-if="ticket.priority == 'high'"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        class="w-4 h-4 mr-1 fill-current text-red-500"
                    >
                        <path
                            d="M24,12A12,12,0,1,1,12,0,12.013,12.013,0,0,1,24,12ZM13,5H11V15h2Zm0,12H11v2h2Z"
                        />
                    </svg>
                    <div
                        v-if="ticket.priority == 'critical'"
                        class="flex flex-row align-middle items-center font-bold text-red-700"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                            class="w-4 h-4 mr-1 fill-current"
                        >
                            <path
                                d="M24,12A12,12,0,1,1,12,0,12.013,12.013,0,0,1,24,12ZM13,5H11V15h2Zm0,12H11v2h2Z"
                            />
                        </svg>
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                            class="w-4 h-4 mr-1 fill-current"
                        >
                            <path
                                d="M23,12a1,1,0,0,1-1,1H19.13a3.016,3.016,0,0,1-2.569-1.452L15.193,9.277,13.706,12.9a1,1,0,0,1-1.851-.758L13.555,8H11.616L9.552,13.032a1,1,0,0,0,.39,1.225l4.592,2.9A1,1,0,0,1,15,18v5a1,1,0,0,1-2,0V18.551l-4.126-2.6A3,3,0,0,1,7.7,12.273L9.454,8H7.236a.994.994,0,0,0-.894.552L4.895,11.447a1,1,0,0,1-1.79-.894l1.448-2.9A2.984,2.984,0,0,1,7.236,6h6.623A3.017,3.017,0,0,1,16.43,7.453l1.844,3.063A1.006,1.006,0,0,0,19.13,11H22A1,1,0,0,1,23,12ZM7.875,16.814a1,1,0,0,0-1.3.557A.994.994,0,0,1,5.646,18H3a1,1,0,0,0,0,2H5.646a2.987,2.987,0,0,0,2.786-1.886A1,1,0,0,0,7.875,16.814ZM15,5a2.5,2.5,0,1,0-2.5-2.5A2.5,2.5,0,0,0,15,5Z"
                            />
                        </svg>
                    </div>
                </div>
                <div class="p-1 col-span-4">
                    <div class="font-bold">{{ ticket.title }}</div>
                    <div class="text-slate-700">
                        {{ ticket.description_ex }}
                    </div>
                </div>
                <div
                    class="flex flex-row items-center justify-center p-1 col-span-2"
                >
                    {{ ticket.issuedBy }}
                </div>
                <div
                    class="flex flex-row items-center justify-center p-1 col-span-2"
                >
                    {{ ticket.assignedTo }}
                </div>
                <div class="flex flex-row items-center justify-center p-1">
                    {{ ticket.updatedOn }}
                </div>
                <div class="flex flex-row items-center justify-center p-1">
                    {{ ticket.createdOn }}
                </div>
            </div>
        </div>
    </div>
    
    <div v-else>
        <%- include('../../components/chill/_index.ejs') %>
    </div>
</div>


<script>
    var vue = new Vue({
        el: "#ticket-list",
        data() {
            return {
                fetchedTickets: <%- JSON.stringify(tickets) %>,
                definition: <%- JSON.stringify(definition) %>,
                sorting: {
                    property: '', direction: 0,
                },
            }
        },
        methods: {
            goTo(id) {
                window.location.href = `/ticket/id?id=${id}`
            },
            setSorting(property, groupingAvailable) {
                if(property == this.sorting.property && this.sorting.direction == 1) {
                    this.sorting.direction = -1
                } else if (property == this.sorting.property && this.sorting.direction == -1) {
                    if(groupingAvailable) {
                        this.sorting.direction = 2
                    } else {
                        this.sorting = {
                            property: '',
                            direction: 0
                        }
                    }
                } else if (property == this.sorting.property && this.sorting.direction == 2) {
                    this.sorting = {
                        property: '',
                        direction: 0
                    }
                }
                else {
                    this.sorting = {
                        property: property,
                        direction: 1,
                    }
                }
            }
        },
        computed: {
            tickets() {
                if(this.sorting.direction == 1 || this.sorting.direction == -1) {
                    this.fetchedTickets.sort((a, b) => (a[this.sorting.property] > b[this.sorting.property]) ? (1 * this.sorting.direction) : (-1 * this.sorting.direction))
                } else if(this.sorting.direction == 2) {
                    let uniqueProperty = new Set()
                    this.fetchedTickets.forEach(ticket => {
                        uniqueProperty.add(ticket[this.sorting.property])
                    });
                    let groupedTickets = []
                    uniqueProperty.forEach(prop => {
                        groupedTickets[prop] = this.fetchedTickets.filter(ticket => ticket[this.sorting.property] == prop)
                    });
                    console.log(groupedTickets)
                    return groupedTickets
                }
                return this.fetchedTickets
            }
        },
    })
</script>

<%- include('../../components/footer/_index.ejs') %>
